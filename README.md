# ğŸš— Vehicle Detection using Canny + HOG + Linear SVM (Classical Computer Vision)

This project implements a **classical computer visionâ€“based vehicle detection system** using **Canny edge detection**, **Histogram of Oriented Gradients (HOG)**, and a **Linear Support Vector Machine (SVM)**.  
The system is deployed as an **interactive Streamlit application** that visualizes **every stage of the detection pipeline**, from preprocessing to final bounding box output.

Unlike deep learning approaches, this project demonstrates how **traditional feature engineering + machine learning** can still be effective, interpretable, and efficient in low-resource environments.

---

## ğŸ“Œ Project Overview

The goal of this project is to detect **vehicles in images** using a **sliding window + image pyramid** approach and return **a single merged bounding box** representing the detected vehicle.

### Key Characteristics
- Classical CV approach (no deep learning)
- Canny edgeâ€“based HOG feature extraction
- Linear SVM classifier
- Sliding window + image pyramid scanning
- Hard Negative Mining for performance improvement
- Heatmap visualization of detection confidence
- Export results in **YOLO bounding box format**
- Fully interactive **Streamlit UI**

---

## ğŸ§  Detection Pipeline

The detection pipeline follows these steps:

1. **Input Image**
2. **Resize (speed cap for scanning)**
3. **Grayscale Conversion**
4. **Canny Edge Detection**
5. **Sliding Window (128Ã—64)**
6. **HOG Feature Extraction**
7. **Feature Scaling**
8. **Linear SVM Decision Function**
9. **Score Aggregation**
10. **Top-K Bounding Box Merge**
11. **Heatmap Generation**
12. **YOLO-style Output Export**

All stages can be visualized directly inside the Streamlit application.

---

## ğŸ§© Methodology Details

### 1. Canny Edge Detection
Canny edges are extracted to emphasize object contours and suppress texture noise.

```text
Input â†’ Grayscale â†’ Canny(t1, t2)
Adjustable thresholds allow fine control over edge sensitivity.

2. HOG Feature Extraction
HOG features are computed on 128Ã—64 patches, which is the standard window size for vehicle detection.

HOG configuration:

Orientations: 9

Pixels per cell: (8Ã—8)

Cells per block: (2Ã—2)

Block normalization: L2-Hys

These features capture edge orientation and structure, making them suitable for rigid objects like vehicles.

3. Linear SVM Classification
A Linear SVM is trained to classify each window as:

1 â†’ Vehicle

0 â†’ Non-vehicle

The decision_function score is used instead of probabilities to:

Rank windows

Build score distributions

Generate heatmaps

A sigmoid mapping is applied only for visualization, not calibration.

4. Sliding Window + Image Pyramid
To detect vehicles at multiple scales:

An image pyramid progressively downsamples the image

A sliding window scans each pyramid level

Window positions are mapped back to the original image

Scanning can be restricted to lower regions of the image to reduce false positives (e.g., sky, trees).

5. Hard Negative Mining
To reduce false positives:

The model scans negative images

High-scoring false positives are collected

These samples are added as new negative training data

The SVM is retrained iteratively

This significantly improves robustness against background patterns.

6. Bounding Box Merge (Single Output)
Instead of outputting many boxes:

Strong positive windows are filtered by score

Top-K windows are selected

All selected windows are merged into one union bounding box

This produces a clean single-vehicle output, ideal for demos and downstream tasks.

7. Heatmap Visualization
A confidence heatmap is generated by:

Painting each windowâ€™s score into its bounding box region

Taking the maximum score per pixel

Normalizing and applying a color map

Red regions indicate high confidence vehicle presence.

ğŸ“Š Outputs
The application provides:

Final merged bounding box

Confidence score

YOLO-style annotation (single line)

Downloadable result image

Downloadable heatmap overlay

Downloadable Canny edge image

Score distribution histogram

Pyramid-level evaluation table

ğŸ“‚ Project Structure
powershell
Copy code
project/
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ vehicles/        # Positive samples
â”‚   â””â”€â”€ non-vehicles/    # Negative samples
â”‚
â”œâ”€â”€ canny_hog_svm.pkl    # Trained SVM model
â”œâ”€â”€ canny_scaler.pkl     # Feature scaler
â”œâ”€â”€ app.py               # Streamlit application
â”œâ”€â”€ README.md
â””â”€â”€ requirements.txt
ğŸš€ How to Run the Application
1ï¸âƒ£ Install Dependencies
bash
Copy code
pip install numpy opencv-python scikit-image scikit-learn matplotlib streamlit joblib
2ï¸âƒ£ Prepare Dataset
Ensure the dataset structure is correct:

arduino
Copy code
data/
â”œâ”€â”€ vehicles/
â”‚   â”œâ”€â”€ image1.jpg
â”‚   â”œâ”€â”€ image2.jpg
â”‚   â””â”€â”€ ...
â””â”€â”€ non-vehicles/
    â”œâ”€â”€ image1.jpg
    â”œâ”€â”€ image2.jpg
    â””â”€â”€ ...
3ï¸âƒ£ Run the Streamlit App
bash
Copy code
streamlit run app.py
Open in browser:

arduino
Copy code
http://localhost:8501
ğŸ›ï¸ Streamlit Controls
The UI allows real-time adjustment of:

Canny thresholds

Sliding window step size

Pyramid scale and levels

Scan region (vertical ratio)

Positive score threshold

Top-K window merge count

Heatmap smoothing

Hard negative mining parameters

This makes the system ideal for educational visualization and experimentation.

ğŸ“¤ Export Formats
YOLO Annotation
Single bounding box in YOLO format:

arduino
Copy code
class_id x_center y_center width height
(all values normalized to [0,1])

âš ï¸ Limitations
Slower than deep learning methods on large images

Requires careful threshold tuning

Sensitive to extreme viewpoint changes

Not suitable for dense multi-object scenes

ğŸ”® Future Improvements
Non-Maximum Suppression (NMS) for multi-object output

Multi-class SVM support

Faster scanning using integral HOG

Integration with deep features (hybrid CV + DL)

Video stream support

ğŸ‘¤ Author Owen Figo
Vehicle Detection using Classical Computer Vision
Developed for educational and experimental purposes.

ğŸ“„ License
This project is intended for academic, educational, and research use.
Free to use and modify with appropriate attribution.
